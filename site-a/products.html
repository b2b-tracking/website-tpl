<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" th:content="${siteSeo != null ? siteSeo.description : ''}" content="æŸ¥çœ‹æˆ‘ä»¬çš„å…¨éƒ¨äº§å“ç³»åˆ—">
  <meta name="keywords" th:content="${siteSeo != null ? siteSeo.keywords : ''}" content="">
  <title th:text="${siteSeo != null ? siteSeo.title : site.name}">äº§å“ä¸­å¿ƒ - ManufacturePro</title>
  <link rel="stylesheet" th:href="@{'/' + ${lang} + '/css/style.css'}">
</head>
<body>
  <!-- å¯¼èˆªæ  -->
  <nav class="navbar">
    <div class="nav-container">
      <a th:href="@{'/' + ${lang} + '/'}" class="logo">
        <img th:if="${site.logo}" th:src="@{'/static/' + ${site.logo}}" th:alt="${site.name}" style="height: 40px; vertical-align: middle;">
        <span th:unless="${site.logo}" th:text="${site.name}">ManufacturePro</span>
      </a>
      <button class="mobile-menu-toggle">â˜°</button>
      <ul class="nav-menu">
        <li th:each="menu : ${menus}">
          <a th:href="@{'/' + ${lang} + '/' + ${menu.target_url}}" class="nav-link"
             th:text="${menu.menu_name}">èœå•</a>
        </li>
        <li class="lang-switcher">
          <button class="lang-btn" th:classappend="${lang == 'zh'} ? 'active'" data-lang="zh"
                  th:onclick="'window.location.href=\'' + @{'/zh/products'} + '\''">ä¸­æ–‡</button>
          <button class="lang-btn" th:classappend="${lang == 'en'} ? 'active'" data-lang="en"
                  th:onclick="'window.location.href=\'' + @{'/en/products'} + '\''">EN</button>
        </li>
      </ul>
    </div>
  </nav>

  <!-- äº§å“åˆ—è¡¨ -->
  <section class="container" style="margin-top: 6rem;">
    <h2 class="section-title" data-i18n="products.title">æˆ‘ä»¬çš„äº§å“</h2>
    <p class="section-subtitle" data-i18n="products.subtitle">ä¸ºæ‚¨æä¾›ä¼˜è´¨çš„äº§å“å’ŒæœåŠ¡</p>

    <!-- åˆ†ç±»ç­›é€‰ -->
    <div style="margin: 2rem 0; display: flex; gap: 1rem; flex-wrap: wrap; justify-content: center;">
      <a th:href="@{'/' + ${lang} + '/products'}"
         th:classappend="${selectedCategory == null} ? 'active'"
         class="category-filter-btn"
         data-i18n="products.allProducts">
        å…¨éƒ¨äº§å“
      </a>
      <a th:each="cat : ${categories}"
         th:href="@{'/' + ${lang} + '/products?category=' + ${cat.id}}"
         th:classappend="${selectedCategory != null && selectedCategory == cat.id} ? 'active'"
         class="category-filter-btn"
         th:text="${cat.name}">
        åˆ†ç±»
      </a>
    </div>

    <div class="products-grid" id="products-container" style="margin-top: 3rem;">
      <div th:each="product, iterStat : ${products}" class="product-card"
           th:onclick="'window.location.href=\'' + @{'/' + ${lang} + '/products/' + ${product.id}} + '\''">
        <div class="product-image" th:if="${product.mainImage}"
             th:style="'background-image: url(' + ${product.mainImage} + '); background-size: contain; background-position: center; background-repeat: no-repeat;'">
        </div>
        <div class="product-image" th:unless="${product.mainImage}"
             th:style="'background: linear-gradient(135deg, hsl(' + ${(iterStat.index * 60) % 360} + ', 70%, 60%) 0%, hsl(' + ${((iterStat.index * 60) + 30) % 360} + ', 70%, 50%) 100%);'">
          <span>ğŸ“¦</span>
        </div>
        <div class="product-info">
          <h3 class="product-title" th:text="${product.name}">äº§å“åç§°</h3>
          <p class="product-description" th:text="${product.shortDescription}">äº§å“ç®€ä»‹</p>
          <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
            <a th:href="@{'/' + ${lang} + '/products/' + ${product.id}}" class="btn btn-outline" style="flex: 1;" data-i18n="products.viewDetails" onclick="event.stopPropagation()">æŸ¥çœ‹è¯¦æƒ…</a>
            <a th:href="@{'/' + ${lang} + '/#contact'}" class="btn" style="flex: 1;" data-i18n="products.getQuote" onclick="event.stopPropagation()">è·å–æŠ¥ä»·</a>
          </div>
        </div>
      </div>
    </div>

    <!-- ç©ºçŠ¶æ€ -->
    <div th:if="${products == null || products.isEmpty()}" style="text-align: center; padding: 4rem 0;">
      <p style="color: var(--text-light); font-size: 1.2rem;" data-i18n="products.noProducts">æš‚æ— äº§å“</p>
    </div>

    <!-- åˆ†é¡µ -->
    <div th:if="${totalPages > 1}" style="display: flex; justify-content: center; align-items: center; gap: 0.5rem; margin-top: 3rem;">
      <a th:if="${currentPage > 1}"
         th:href="${selectedCategory != null} ? @{/} + ${lang} + '/products?page=' + ${currentPage - 1} + '&category=' + ${selectedCategory} : @{/} + ${lang} + '/products?page=' + ${currentPage - 1}"
         class="pagination-btn">&lt;</a>

      <span th:each="i : ${#numbers.sequence(1, totalPages)}"
            th:if="${i == 1 || i == totalPages || (i >= currentPage - 2 && i <= currentPage + 2)}">
        <a th:if="${i != currentPage}"
           th:href="${selectedCategory != null} ? @{/} + ${lang} + '/products?page=' + ${i} + '&category=' + ${selectedCategory} : @{/} + ${lang} + '/products?page=' + ${i}"
           class="pagination-btn"
           th:text="${i}">1</a>
        <span th:if="${i == currentPage}"
              class="pagination-btn active"
              th:text="${i}">1</span>
      </span>

      <a th:if="${currentPage < totalPages}"
         th:href="${selectedCategory != null} ? @{/} + ${lang} + '/products?page=' + ${currentPage + 1} + '&category=' + ${selectedCategory} : @{/} + ${lang} + '/products?page=' + ${currentPage + 1}"
         class="pagination-btn">&gt;</a>
    </div>
  </section>

  <!-- é¡µè„š -->
  <footer class="footer">
    <div class="footer-content">
      <div class="footer-section">
        <h3 th:text="${siteI18n != null ? siteI18n.site_name : site.name}">ManufacturePro</h3>
        <p th:text="${siteI18n != null ? siteI18n.description : ''}">æˆ‘ä»¬æ˜¯ä¸€å®¶ä¸“æ³¨äºåˆ›æ–°äº§å“ç ”å‘å’Œåˆ¶é€ çš„ä¼ä¸šï¼Œè‡´åŠ›äºä¸ºå…¨çƒå®¢æˆ·æä¾›é«˜å“è´¨çš„äº§å“å’ŒæœåŠ¡ã€‚</p>
      </div>

      <div class="footer-section">
        <h3 data-i18n="products.title">äº§å“ä¸­å¿ƒ</h3>
        <a th:each="category : ${categories}"
           th:href="@{'/' + ${lang} + '/products?category=' + ${category.id}}"
           th:text="${category.name}">äº§å“åˆ†ç±»</a>
      </div>

      <div class="footer-section">
        <h3 data-i18n="footer.quickLinks">å¿«é€Ÿé“¾æ¥</h3>
        <a th:href="@{'/' + ${lang} + '/about'}"><span data-i18n="nav.about">å…³äºæˆ‘ä»¬</span></a>
        <a th:href="@{'/' + ${lang} + '/news'}"><span data-i18n="nav.news">æ–°é—»èµ„è®¯</span></a>
        <a href="#contact"><span data-i18n="nav.contact">è”ç³»æˆ‘ä»¬</span></a>
      </div>

      <div class="footer-section" th:if="${contact}">
        <h3 data-i18n="contact.title">è”ç³»æˆ‘ä»¬</h3>
        <p th:if="${contact.address}">ğŸ“ <span th:text="${contact.address}">ä¸­å›½å¹¿ä¸œçœæ·±åœ³å¸‚</span></p>
        <p th:if="${contact.phone}">ğŸ“ <span th:text="${contact.phone}">+86 755-1234-5678</span></p>
        <p th:if="${contact.email}">âœ‰ï¸ <span th:text="${contact.email}">sales@manufacturepro.com</span></p>
      </div>
    </div>

    <div class="footer-bottom">
      <p>&copy; 2026 <span th:text="${site.name}">ManufacturePro</span>. <span data-i18n="footer.allRightsReserved">ä¿ç•™æ‰€æœ‰æƒåˆ©</span></p>
      <p th:if="${site.icpNumber}" th:text="${site.icpNumber}"></p>
    </div>
  </footer>

  <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
  <div class="back-to-top">â†‘</div>

  <style>
    .category-filter-btn {
      padding: 0.5rem 1.5rem;
      border: 2px solid var(--primary-color);
      border-radius: 25px;
      text-decoration: none;
      color: var(--primary-color);
      transition: all 0.3s;
      background: white;
      font-weight: 500;
      display: inline-block;
    }
    .category-filter-btn:hover {
      background: var(--primary-color);
      color: white !important;
    }
    .category-filter-btn.active {
      background: var(--primary-color);
      color: white !important;
    }

    .pagination-btn {
      padding: 0.5rem 1rem;
      border: 1px solid #ddd;
      border-radius: 4px;
      text-decoration: none;
      color: var(--text-color);
      background: white;
      transition: all 0.3s;
      min-width: 40px;
      text-align: center;
      display: inline-block;
    }
    .pagination-btn:hover {
      background: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
    }
    .pagination-btn.active {
      background: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
      font-weight: bold;
    }
  </style>

  <!-- è„šæœ¬ -->
  <script th:src="@{'/' + ${lang} + '/js/i18n.js'}"></script>
  <script th:src="@{'/' + ${lang} + '/js/main.js'}"></script>
</body>
</html>
