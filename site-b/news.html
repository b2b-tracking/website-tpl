<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" th:content="${siteSeo != null ? siteSeo.description : ''}" content="了解公司动态和行业资讯">
  <meta name="keywords" th:content="${siteSeo != null ? siteSeo.keywords : ''}" content="">
  <title th:text="${siteSeo != null ? siteSeo.title : (site != null ? site.name : 'Smoant')}">新闻资讯</title>
  <link rel="stylesheet" th:href="@{'/' + ${lang} + '/css/style.css'}">
</head>
<body>
  <!-- 导航栏 -->
  <nav class="navbar" id="navbar">
    <div class="nav-container">
      <div class="nav-logo">
        <a th:href="@{'/' + ${lang} + '/'}" class="logo-link">
          <img th:if="${site != null && site.logo}" th:src="@{'/static/' + ${site.logo}}" th:alt="${site != null ? site.name : 'Smoant'}" class="logo-img">
          <span th:unless="${site != null && site.logo}" th:text="${site != null ? site.name : 'Smoant'}" class="logo-text">Smoant</span>
        </a>
      </div>

      <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle menu">
        <span></span>
        <span></span>
        <span></span>
      </button>

      <ul class="nav-menu" id="navMenu">
        <!-- 动态菜单 -->
        <li class="nav-item" th:each="menu : ${menus}">
          <a th:href="@{'/' + ${lang} + '/' + ${menu.target_url}}" class="nav-link" th:text="${menu.menu_name}">菜单</a>
        </li>
        <!-- 备用菜单 -->
        <li class="nav-item" th:if="${menus == null || menus.isEmpty()}">
          <a th:href="@{'/' + ${lang} + '/'}" class="nav-link" data-i18n="nav.home">首页</a>
        </li>
        <li class="nav-item" th:if="${menus == null || menus.isEmpty()}">
          <a th:href="@{'/' + ${lang} + '/products'}" class="nav-link" data-i18n="nav.products">产品中心</a>
        </li>
        <li class="nav-item" th:if="${menus == null || menus.isEmpty()}">
          <a th:href="@{'/' + ${lang} + '/news'}" class="nav-link active" data-i18n="nav.news">新闻资讯</a>
        </li>
        <li class="nav-item" th:if="${menus == null || menus.isEmpty()}">
          <a th:href="@{'/' + ${lang} + '/about'}" class="nav-link" data-i18n="nav.about">关于我们</a>
        </li>

        <li class="nav-item nav-lang-switcher">
          <button class="lang-btn" th:classappend="${lang == 'zh'} ? 'active'" data-lang="zh"
                  onclick="switchLanguage('zh')">中文</button>
          <button class="lang-btn" th:classappend="${lang == 'en'} ? 'active'" data-lang="en"
                  onclick="switchLanguage('en')">EN</button>
        </li>
      </ul>
    </div>
  </nav>

  <!-- 新闻列表 -->
  <section style="margin-top: 80px; padding: 4rem 2rem;">
    <div class="section-container">
      <h2 class="section-title" data-i18n="news.latest">最新动态</h2>
      <p class="section-subtitle" data-i18n="news.subtitle">了解公司动态和行业资讯</p>

      <!-- 新闻网格 -->
      <div class="discover-grid" style="margin-top: 3rem;">
        <div th:each="newsItem, iterStat : ${news}"
             style="background: white; border-radius: 8px; overflow: hidden; box-shadow: var(--shadow); cursor: pointer; transition: all 0.3s ease;"
             th:onclick="'window.location.href=\'' + @{'/' + ${lang} + '/news/' + ${newsItem.id}} + '\''">
          <div class="discover-image"
               th:if="${newsItem.cover_image}"
               th:style="'background-image: url(' + @{'/static/' + ${newsItem.cover_image}} + '); background-size: cover; background-position: center; height: 220px;'">
          </div>
          <div class="discover-image" th:unless="${newsItem.cover_image}"
               th:style="'background: linear-gradient(135deg, hsl(' + ${(iterStat.index * 120) % 360} + ', 70%, 60%) 0%, hsl(' + ${((iterStat.index * 120) + 50) % 360} + ', 70%, 50%) 100%); height: 220px;'">
          </div>
          <div style="padding: 1.5rem;">
            <h3 class="product-title" th:text="${newsItem.title}" style="margin-bottom: 0.8rem;">新闻标题</h3>
            <p class="product-desc" th:text="${newsItem.summary}" style="margin-bottom: 1rem;">新闻摘要</p>
            <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 1rem; border-top: 1px solid var(--border-color);">
              <span style="color: var(--text-light); font-size: 0.9rem;">📅 <span th:text="${#temporals.format(newsItem.publish_time, 'yyyy-MM-dd')}">2026-01-10</span></span>
              <a th:href="@{'/' + ${lang} + '/news/' + ${newsItem.id}}" class="discover-more" style="color: #000; text-decoration: none; font-weight: 600;" data-i18n="news.readMore">阅读更多 →</a>
            </div>
          </div>
        </div>
      </div>

      <!-- 空状态 -->
      <div th:if="${news == null || news.isEmpty()}" style="text-align: center; padding: 4rem 0;">
        <p style="color: var(--text-light); font-size: 1.2rem;">暂无新闻资讯</p>
      </div>

      <!-- 分页 -->
      <div th:if="${totalPages > 1}" style="display: flex; justify-content: center; align-items: center; gap: 0.5rem; margin-top: 3rem;">
        <a th:if="${currentPage > 1}"
           th:href="@{/} + ${lang} + '/news?page=' + ${currentPage - 1}"
           class="pagination-btn" style="padding: 0.5rem 1rem; border: 1px solid #ddd; text-decoration: none; color: var(--text-color); background: white; transition: all 0.3s; min-width: 40px; text-align: center; display: inline-block;">&lt;</a>

        <span th:each="i : ${#numbers.sequence(1, totalPages)}"
              th:if="${i == 1 || i == totalPages || (i >= currentPage - 2 && i <= currentPage + 2)}">
          <a th:if="${i != currentPage}"
             th:href="@{/} + ${lang} + '/news?page=' + ${i}"
             class="pagination-btn"
             style="padding: 0.5rem 1rem; border: 1px solid #ddd; text-decoration: none; color: var(--text-color); background: white; transition: all 0.3s; min-width: 40px; text-align: center; display: inline-block; margin: 0 2px;"
             th:text="${i}">1</a>
          <span th:if="${i == currentPage}"
                class="pagination-btn active"
                style="padding: 0.5rem 1rem; border: 1px solid #000; background: #000; color: var(--accent-color); min-width: 40px; text-align: center; display: inline-block; margin: 0 2px; font-weight: bold;"
                th:text="${i}">1</span>
        </span>

        <a th:if="${currentPage < totalPages}"
           th:href="@{/} + ${lang} + '/news?page=' + ${currentPage + 1}"
           class="pagination-btn" style="padding: 0.5rem 1rem; border: 1px solid #ddd; text-decoration: none; color: var(--text-color); background: white; transition: all 0.3s; min-width: 40px; text-align: center; display: inline-block;">&gt;</a>
      </div>
    </div>
  </section>

  <!-- 页脚 -->
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-column">
        <h4 th:text="${site.name}">Smoant</h4>
        <a th:href="@{'/' + ${lang} + '/'}" style="text-decoration: none; color: inherit; display: block;" data-i18n="nav.home">首页</a>
        <a th:href="@{'/' + ${lang} + '/about'}" style="text-decoration: none; color: inherit; display: block;" data-i18n="nav.about">关于我们</a>
        <a th:href="@{'/' + ${lang} + '/news'}" style="text-decoration: none; color: inherit; display: block;" data-i18n="nav.news">新闻资讯</a>
      </div>

      <div class="footer-column">
        <h4 data-i18n="products.title">产品中心</h4>
        <a th:each="category : ${categories}"
           th:href="@{'/' + ${lang} + '/products?category=' + ${category.id}}"
           th:text="${category.name}"
           style="text-decoration: none; color: inherit; display: block;">产品分类</a>
      </div>

      <div class="footer-column">
        <h4 data-i18n="footer.quickLinks">快速链接</h4>
        <a th:href="@{'/' + ${lang} + '/community'}" data-i18n="nav.community" style="text-decoration: none; color: inherit; display: block;">社区</a>
        <a th:href="@{'/' + ${lang} + '/support'}" data-i18n="nav.support" style="text-decoration: none; color: inherit; display: block;">技术支持</a>
        <a href="/#contact" data-i18n="nav.contact" style="text-decoration: none; color: inherit; display: block;">联系我们</a>
      </div>

      <div class="footer-column">
        <h4 data-i18n="contact.title">联系我们</h4>
        <p th:if="${contact.address}">📍 <span th:text="${contact.address}">地址</span></p>
        <p th:if="${contact.phone}">📞 <span th:text="${contact.phone}">电话</span></p>
        <p th:if="${contact.email}">✉️ <span th:text="${contact.email}">邮箱</span></p>
      </div>
    </div>

    <div class="footer-bottom">
      <p>&copy; 2026 <span th:text="${site.name}">Smoant</span>. <span data-i18n="footer.allRightsReserved">保留所有权利</span></p>
      <p style="color: #ff6b6b; font-size: 0.85rem; margin: 0.5rem 0;" data-i18n="footer.warning">本产品含有尼古丁，尼古丁是一种令人上瘾的化学物质</p>
      <p style="font-size: 0.85rem; color: var(--text-light);">
        <a href="#" style="text-decoration: none; color: inherit;" data-i18n="footer.privacyPolicy">隐私政策</a>
        &nbsp; | &nbsp;
        <a href="#" style="text-decoration: none; color: inherit;" data-i18n="footer.termsOfService">服务条款</a>
      </p>
      <p th:if="${site.icpNumber}" th:text="${site.icpNumber}"></p>
    </div>
  </footer>

  <!-- 返回顶部按钮 -->
  <div class="back-to-top">↑</div>

  <!-- 脚本 -->
  <script th:src="@{'/' + ${lang} + '/js/i18n.js'}"></script>
  <script th:src="@{'/' + ${lang} + '/js/main.js'}"></script>

  <script>
    // 语言切换
    function switchLanguage(lang) {
      const currentPath = window.location.pathname;
      const pathParts = currentPath.split('/').filter(p => p);
      if (pathParts[0] === 'zh' || pathParts[0] === 'en') {
        pathParts[0] = lang;
      } else {
        pathParts.unshift(lang);
      }
      window.location.href = '/' + pathParts.join('/');
    }
  </script>
</body>
</html>
