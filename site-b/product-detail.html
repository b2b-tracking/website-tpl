<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" th:content="${product.shortDescription}" content="äº§å“è¯¦ç»†ä¿¡æ¯">
  <title th:text="${product.name} + ' - ' + ${site.name}">äº§å“è¯¦æƒ…</title>
  <link rel="stylesheet" th:href="@{'/' + ${lang} + '/css/style.css'}">
  <link rel="stylesheet" th:href="@{'/' + ${lang} + '/css/widget-posts.min.css'}">
  <link rel="stylesheet" th:href="@{'/' + ${lang} + '/css/navbar-footer.css'}">
  <link rel="stylesheet" th:href="@{'/' + ${lang} + '/css/animations.css'}">
  <style>
    body {
      background: #f5f5f5;
    }

    /* ç¡®ä¿é¡µè„šæ ·å¼ä¼˜å…ˆ */
    .footer {
      background: #2c3e50;
      color: #ecf0f1;
      padding: 3rem 2rem 1.5rem;
      display: block;
    }

    /* é¢åŒ…å±‘ */
    .breadcrumb {
      max-width: 900px;
      margin: 0 auto;
      padding: 2rem 2rem 0;
      color: #999;
      font-size: 0.9rem;
    }

    .breadcrumb a {
      color: #666;
      text-decoration: none;
      transition: color 0.3s;
    }

    .breadcrumb a:hover {
      color: var(--primary-blue);
    }

    /* Hero Banner */
    .products-banner {
      position: relative;
      height: 400px;
      background: linear-gradient(135deg, #7FA8DA 0%, #9BC4E8 50%, #C4D9EC 100%);
      display: flex;
      align-items: center;
      overflow: hidden;
    }

    .products-banner::before {
      content: 'DETAILED';
      position: absolute;
      top: 50%;
      right: -10%;
      transform: translateY(-50%);
      font-size: 20rem;
      font-weight: 900;
      color: rgba(255, 255, 255, 0.2);
      letter-spacing: -0.05em;
      z-index: 1;
      line-height: 1;
    }

    .products-banner-content {
      position: relative;
      z-index: 2;
      text-align: left;
      color: white;
      max-width: 1400px;
      width: 100%;
      margin: 0 auto;
      padding: 0 4rem;
    }

    .products-banner-title {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 0.8rem;
      letter-spacing: 0;
    }

    .products-banner-subtitle {
      font-size: 1rem;
      opacity: 1;
      letter-spacing: 0;
      font-weight: 300;
    }

    /* å†…å®¹åŒºåŸŸ */
    .content-section {
      padding: 3rem 2rem 4rem;
      max-width: 1400px;
      margin: 0 auto;
    }

    /* äº§å“ä¿¡æ¯åŒº - å·¦å³å¸ƒå±€ */
    .product-info-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 3rem;
      background: white;
      padding: 3rem;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
      margin-bottom: 2rem;
    }

    /* å·¦ä¾§ä¸»å›¾åŒº */
    .product-image-section {
      position: relative;
    }

    .product-main-image-large {
      width: 100%;
      border-radius: 8px;
      overflow: hidden;
      background: #f9f9f9;
    }

    .product-main-image-large img {
      width: 100%;
      height: auto;
      display: block;
    }

    /* å³ä¾§å±æ€§åŒº */
    .product-details-section {
      display: flex;
      flex-direction: column;
    }

    .product-title {
      font-size: 2rem;
      font-weight: 700;
      margin: 0 0 1rem 0;
      color: #333;
      line-height: 1.3;
    }

    .product-short-desc {
      color: #666;
      font-size: 1rem;
      line-height: 1.8;
      margin-bottom: 2rem;
      padding-bottom: 2rem;
      border-bottom: 1px solid #e5e7eb;
    }

    /* äº§å“è¯¦æƒ…åŒº - ä¸‹æ–¹ */
    .product-detail-content {
      background: white;
      padding: 3rem;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
    }

    .product-detail-title {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 2rem;
      color: #333;
      padding-bottom: 1rem;
      border-bottom: 2px solid var(--primary-blue);
    }

    /* äº§å“å±æ€§åˆ—è¡¨ */
    .product-specs {
      flex: 1;
    }

    .product-specs h3 {
      font-size: 1.2rem;
      font-weight: 600;
      margin: 0 0 1.5rem 0;
      color: #333;
    }

    .spec-item {
      display: grid;
      grid-template-columns: 120px 1fr;
      gap: 1rem;
      padding: 0.8rem 0;
      border-bottom: 1px solid #e5e7eb;
    }

    .spec-item:last-child {
      border-bottom: none;
    }

    .spec-label {
      font-weight: 600;
      color: #666;
      font-size: 0.95rem;
    }

    .spec-value {
      color: #333;
      font-size: 0.95rem;
    }

    /* äº§å“å›¾ç‰‡å±•ç¤º */
    .product-images-section {
      margin: 2rem 0;
    }

    .product-image-item {
      margin: 2rem auto;
      text-align: center;
    }

    .product-image-item img {
      width: 100%;
      max-width: 600px;
      height: auto;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .product-image-caption {
      margin-top: 1rem;
      font-size: 0.9rem;
      color: #666;
      text-align: center;
    }

    /* è¡ŒåŠ¨æŒ‰é’®åŒº */
    .product-actions {
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      margin: 3rem 0 2rem;
      padding: 2rem 0;
      border-top: 1px solid #eee;
    }

    .btn {
      padding: 0.9rem 2.5rem;
      border-radius: 4px;
      text-decoration: none;
      text-align: center;
      font-size: 0.95rem;
      transition: all 0.3s;
      display: inline-block;
      font-weight: 500;
      cursor: pointer;
    }

    .btn-primary {
      background: var(--primary-blue);
      color: white;
      border: 1px solid var(--primary-blue);
    }

    .btn-primary:hover {
      background: #3a7bc8;
      border-color: #3a7bc8;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
    }

    .btn-outline {
      background: white;
      color: #333;
      border: 1px solid #ddd;
    }

    .btn-outline:hover {
      background: #f5f5f5;
      border-color: #bbb;
    }

    /* åº•éƒ¨å¯¼èˆª */
    .bottom-nav {
      display: flex;
      justify-content: space-between;
      padding: 1.5rem 0 0;
      margin-top: 2rem;
      border-top: 1px solid #eee;
      font-size: 0.9rem;
    }

    .bottom-nav a {
      color: var(--primary-blue);
      text-decoration: none;
      transition: color 0.3s;
    }

    .bottom-nav a:hover {
      color: #3a7bc8;
      text-decoration: underline;
    }

    .nav-prev {
      text-align: left;
    }

    .nav-next {
      text-align: right;
    }

    /* å“åº”å¼ */
    @media (max-width: 1024px) {
      .product-info-grid {
        grid-template-columns: 1fr;
        gap: 2rem;
      }
    }

    @media (max-width: 768px) {
      .breadcrumb {
        padding: 1.5rem 1.5rem 0;
      }

      .content-section {
        padding: 2rem 1rem 3rem;
      }

      .product-info-grid {
        padding: 2rem 1.5rem;
      }

      .product-detail-content {
        padding: 2rem 1.5rem;
      }

      .product-title {
        font-size: 1.5rem;
      }

      .spec-item {
        grid-template-columns: 100px 1fr;
      }

      .product-actions {
        flex-direction: column;
        gap: 1rem;
      }

      .btn {
        width: 100%;
      }

      .bottom-nav {
        flex-direction: column;
        gap: 1rem;
      }

      .nav-next {
        text-align: left;
      }
    }
  </style>
</head>

<body>
  <!-- å¯¼èˆªæ  -->
  <nav class="navbar">
    <div class="nav-container">
      <a th:href="@{'/' + ${lang} + '/'}" class="logo">
        <img th:if="${site.logo}" th:src="@{${site.logo}}" th:alt="${site.name}"
          style="height: 40px; vertical-align: middle;">
        <span th:unless="${site.logo}" th:text="${site.name}"></span>
      </a>
      <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">â˜°</button>
      <ul class="nav-menu" id="navMenu">
        <li th:each="menu : ${menus}">
          <a th:href="@{'/' + ${lang} + '/' + ${menu.target_url}}" class="nav-link" th:text="${menu.menu_name}"></a>
        </li>
        <li class="lang-switcher">
          <button type="button" class="lang-btn" th:classappend="${lang == 'zh'} ? 'active'"
            onclick="switchLanguage('zh'); return false;">ä¸­æ–‡</button>
          <button type="button" class="lang-btn" th:classappend="${lang == 'en'} ? 'active'"
            onclick="switchLanguage('en'); return false;">EN</button>
        </li>
      </ul>
    </div>
  </nav>
  <!-- Hero Banner -->
  <section class="products-banner">
    <div class="products-banner-content">
      <h1 class="products-banner-title" data-i18n="products.titleDetail">äº§å“ä¸­å¿ƒ</h1>
      <p class="products-banner-subtitle" data-i18n="products.subtitle">ä¸ºæ‚¨æä¾›ä¼˜è´¨çš„äº§å“å’ŒæœåŠ¡</p>
    </div>
  </section>

  <!-- äº§å“è¯¦æƒ…å†…å®¹ -->
  <section class="content-section" th:if="${product}">

    <!-- ä¸Šæ–¹ï¼šå·¦è¾¹ä¸»å›¾ï¼Œå³è¾¹å±æ€§ -->
    <div class="product-info-grid">
      <!-- å·¦ä¾§ï¼šä¸»å›¾ -->
      <div class="product-image-section">
        <div class="product-main-image-large">
          <img th:if="${product.mainImage}" th:src="${product.mainImage}" th:alt="${product.name}" loading="lazy">
          <div th:unless="${product.mainImage}" style="aspect-ratio: 1; background: linear-gradient(135deg, #7FA8DA, #C4D9EC); display: flex; align-items: center; justify-content: center; font-size: 4rem;">
            ğŸ“¦
          </div>
        </div>
      </div>

      <!-- å³ä¾§ï¼šæ ‡é¢˜ + ç®€ä»‹ + å±æ€§ -->
      <div class="product-details-section">
        <h1 class="product-title" th:text="${product.name}">äº§å“åç§°</h1>

        <div th:if="${product.shortDescription}" class="product-short-desc">
          <p th:text="${product.shortDescription}">äº§å“ç®€ä»‹</p>
        </div>

        <!-- äº§å“å±æ€§ -->
        <div th:if="${product.attributes != null && !product.attributes.isEmpty()}" class="product-specs">
          <h3 data-i18n="productDetail.specifications">äº§å“è§„æ ¼</h3>
          <div th:each="attr : ${product.attributes}" class="spec-item">
            <span class="spec-label" th:text="${attr.name}">å±æ€§å</span>
            <span class="spec-value" th:text="${attr.value}">å±æ€§å€¼</span>
          </div>
        </div>

        <!-- è¯¢ä»·æŒ‰é’® -->
        <div style="margin-top: 2rem; padding-top: 2rem; border-top: 1px solid #e5e7eb;">
          <a th:href="@{'/' + ${lang} + '/contact'}" class="btn btn-primary" style="display: inline-block; background: var(--primary-blue); color: white; padding: 0.9rem 2.5rem; border-radius: 4px; text-decoration: none; font-weight: 600; transition: all 0.3s;" data-i18n="productDetail.inquire">
            ç«‹å³è¯¢ä»·
          </a>
        </div>
      </div>
    </div>

    <!-- ä¸‹æ–¹ï¼šäº§å“è¯¦æƒ…å›¾ç‰‡ -->
    <div th:if="${product.images != null && !product.images.isEmpty()}" class="product-detail-content">
      <h2 class="product-detail-title" data-i18n="productDetail.details">äº§å“è¯¦æƒ…</h2>
      <div class="product-images-section">
        <div th:each="image, iterStat : ${product.images}" class="product-image-item">
          <img th:src="${image}" th:alt="${product.name} + ' - å›¾ç‰‡ ' + ${iterStat.index + 1}" loading="lazy">
        </div>
      </div>
    </div>

  </section>

  <!-- ç©ºçŠ¶æ€ -->
  <section th:unless="${product}" class="content-section" style="text-align: center; padding: 4rem 2rem;">
    <p style="font-size: 1.1rem; color: #999;" data-i18n="productDetail.notFound">äº§å“ä¸å­˜åœ¨æˆ–å·²åˆ é™¤</p>
    <a th:href="@{'/' + ${lang} + '/products'}" class="btn btn-outline" style="margin-top: 2rem; display: inline-block;">
      è¿”å›äº§å“åˆ—è¡¨
    </a>
  </section>

  <!-- é¡µè„š -->
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-column">
        <h4 th:text="${site.name ?: 'CLOUPOR'}">CLOUPOR</h4>
        <p th:text="${siteI18n != null ? siteI18n.description : ''}"></p>
      </div>

      <div class="footer-column">
        <h4 data-i18n="nav.about">å…³äºæˆ‘ä»¬</h4>
        <a th:href="@{'/' + ${lang} + '/about'}" data-i18n="footer.companyProfile">å…¬å¸ç®€ä»‹</a>
      </div>

      <div class="footer-column">
        <h4 data-i18n="products.title">äº§å“ä¸­å¿ƒ</h4>
        <a th:each="category : ${categories}" th:href="@{'/' + ${lang} + '/products?category=' + ${category.id}}"
          th:text="${category.name}">äº§å“åˆ†ç±»</a>
        <a href="#" th:if="${categories.isEmpty()}" data-i18n="footer.allProducts">å…¨éƒ¨äº§å“</a>
      </div>

      <div class="footer-column">
        <h4 data-i18n="footer.quickLinks">å¿«é€Ÿé“¾æ¥</h4>
        <a th:href="@{'/' + ${lang} + '/news'}" data-i18n="nav.news">æ–°é—»èµ„è®¯</a>
        <a th:href="@{'/' + ${lang} + '/contact'}" data-i18n="nav.contact">è”ç³»æˆ‘ä»¬</a>
      </div>

      <!-- <div class="footer-column" th:if="${contact}">
        <h4 data-i18n="contact.title">è”ç³»æˆ‘ä»¬</h4>
        <p th:if="${contact.address}">ğŸ“ <span th:text="${contact.address}">åœ°å€</span></p>
        <p th:if="${contact.phone}">ğŸ“ <span th:text="${contact.phone}">ç”µè¯</span></p>
        <p th:if="${contact.email}">âœ‰ï¸ <span th:text="${contact.email}">é‚®ç®±</span></p>
      </div> -->
    </div>

    <div class="footer-bottom">
      <p>&copy; <span class="year"></span> <span th:text="${site.name ?: 'CLOUPOR'}">CLOUPOR</span>. <span
          data-i18n="footer.allRightsReserved">ä¿ç•™æ‰€æœ‰æƒåˆ©</span></p>
      <p th:if="${site.icpNumber}" th:text="${site.icpNumber}"></p>
    </div>
  </footer>

  <!-- è¿”å›é¡¶éƒ¨ -->
  <div class="back-to-top" onclick="scrollToTop()">â†‘</div>

  <!-- Scripts -->
  <script th:src="@{'/' + ${lang} + '/js/i18n.js'}"></script>
  <script th:src="@{'/' + ${lang} + '/js/main.js'}"></script>
  <script th:src="@{'/' + ${lang} + '/js/animations.js'}"></script>

  <script>
    window.onload = function () {
      document.querySelector('.year').textContent = new Date().getFullYear();

      // ç¡®ä¿è¯­è¨€åˆ‡æ¢æŒ‰é’®å¯ç”¨ - æ·»åŠ å¤‡ç”¨äº‹ä»¶ç›‘å¬
      const langButtons = document.querySelectorAll('.lang-btn');
      langButtons.forEach(function(button) {
        // ç§»é™¤å·²æœ‰çš„ç‚¹å‡»äº‹ä»¶ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
        const clone = button.cloneNode(true);
        button.parentNode.replaceChild(clone, button);

        // æ·»åŠ æ–°çš„ç‚¹å‡»äº‹ä»¶
        clone.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          const lang = this.textContent.trim() === 'ä¸­æ–‡' ? 'zh' : 'en';
          console.log('Language button clicked:', lang);
          switchLanguage(lang);
        });
      });
    };

    // ç§»åŠ¨ç«¯èœå•åˆ‡æ¢
    function toggleMobileMenu() {
      const navMenu = document.getElementById('navMenu');
      navMenu.classList.toggle('active');
    }

    // è¯­è¨€åˆ‡æ¢
    function switchLanguage(lang) {
      try {
        const currentPath = window.location.pathname;
        let pathParts = currentPath.split('/').filter(p => p);

        // å¦‚æœç¬¬ä¸€ä¸ªéƒ¨åˆ†æ˜¯è¯­è¨€ä»£ç ï¼Œæ›¿æ¢å®ƒ
        if (pathParts.length > 0 && (pathParts[0] === 'zh' || pathParts[0] === 'en')) {
          pathParts[0] = lang;
        } else {
          // å¦åˆ™åœ¨å‰é¢æ·»åŠ è¯­è¨€ä»£ç 
          pathParts.unshift(lang);
        }

        const search = window.location.search || '';
        const newUrl = '/' + pathParts.join('/') + search;

        console.log('Switching language to:', lang, 'New URL:', newUrl);
        window.location.href = newUrl;
      } catch (error) {
        console.error('Language switch error:', error);
        // å¤‡ç”¨æ–¹æ¡ˆï¼šç›´æ¥é‡æ–°åŠ è½½é¡µé¢
        window.location.reload();
      }
    }

    // è¿”å›é¡¶éƒ¨
    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // è¿”å›é¡¶éƒ¨æŒ‰é’®æ˜¾ç¤º/éšè—
    window.addEventListener('scroll', function () {
      const backToTop = document.querySelector('.back-to-top');
      if (window.scrollY > 300) {
        backToTop.classList.add('show');
      } else {
        backToTop.classList.remove('show');
      }
    });
  </script>
</body>

</html>
