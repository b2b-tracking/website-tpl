<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" th:content="${siteSeo.description ?: ''}" content="ä¸“ä¸šç”µå­é›¾åŒ–è®¾å¤‡åˆ¶é€ å•†">
  <meta name="keywords" th:content="${siteSeo.keywords ?: ''}" content="">
  <title th:text="${siteSeo.title ?: site.name}">ä¸“ä¸šåˆ¶é€  - å“è´¨ä¸ºå…ˆ</title>
  <link rel="stylesheet" th:href="@{'/' + ${lang} + '/css/style.css'}">
  <link rel="stylesheet" th:href="@{'/' + ${lang} + '/css/navbar-footer.css'}">
  <style>
    /* åŸºç¡€æ ·å¼ */

    /* Hero Banner */
    .hero-banner {
      position: relative;
      min-height: 600px;
      background: linear-gradient(135deg, var(--light-blue) 0%, #d0e8f2 100%);
      overflow: hidden;
    }

    .banner-slide {
      display: none;
      min-height: 600px;
      position: relative;
      background-size: cover;
      background-position: center;
    }

    .banner-slide.active {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }

    .banner-content {
      max-width: 1400px;
      width: 100%;
      padding: 4rem 2rem;
      text-align: center;
      position: relative;
      z-index: 2;
    }

    .banner-content h1{
      text-shadow: 2px 2px 8px rgba(74, 144, 226, 0.5);
    }
    .banner-title {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--primary-blue);
      margin-bottom: 1rem;
      line-height: 1.3;
    }

    .banner-subtitle {
      font-size: 1.2rem;
      color: var(--text-light);
      text-shadow: unset;
      margin-bottom: 2rem;
    }

    .banner-brand {
      font-size: 6rem;
      font-weight: 900;
      color: rgba(255, 255, 255, 0.9);
      text-transform: uppercase;
      letter-spacing: 0.2em;
      margin-top: 2rem;
    }

    .btn {
      display: inline-block;
      padding: 0.8rem 2.5rem;
      background: transparent;
      color: var(--text-dark);
      border: 2px solid var(--text-dark);
      border-radius: 30px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s;
      font-size: 0.95rem;
    }

    .btn:hover {
      background: var(--primary-blue);
      border-color: var(--primary-blue);
      color: white;
      transform: translateY(-2px);
    }

    .banner-dots {
      position: absolute;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      z-index: 3;
    }

    .banner-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.3);
      cursor: pointer;
      transition: all 0.3s;
    }

    .banner-dot.active {
      background: var(--primary-blue);
      width: 30px;
      border-radius: 5px;
    }

    /* è½®æ’­ç®­å¤´ */
    .banner-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 50px;
      height: 50px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      color: white;
      cursor: pointer;
      transition: all 0.3s;
      z-index: 10;
      backdrop-filter: blur(5px);
      user-select: none;
    }

    .banner-arrow:hover {
      background: rgba(255, 255, 255, 0.5);
      transform: translateY(-50%) scale(1.1);
    }

    .banner-arrow-left {
      left: 2rem;
    }

    .banner-arrow-right {
      right: 2rem;
    }

    /* å†…å®¹åŒºå— */
    .content-section {
      padding: 5rem 2rem;
      max-width: 1400px;
      margin: 0 auto;
    }

    .content-section-full {
      padding: 5rem 2rem;
    }

    .content-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 4rem;
      align-items: center;
    }

    .content-image {
      width: 100%;
      border-radius: 12px;
      overflow: hidden;
    }

    .content-image img {
      width: 100%;
      height: auto;
      display: block;
    }

    .content-text h2 {
      font-size: 2.2rem;
      font-weight: 700;
      margin-bottom: 1rem;
      color: var(--text-dark);
      line-height: 1.3;
    }

    .content-text h3 {
      font-size: 1.5rem;
      color: var(--primary-blue);
      margin-bottom: 1.5rem;
      font-weight: 600;
    }

    .content-text p {
      color: var(--text-light);
      margin-bottom: 1rem;
      line-height: 1.8;
    }

    /* æ–°é—»åŠ¨æ€ */
    .news-section {
      background: #f8f9fa;
      padding: 5rem 2rem;
    }

    .section-header {
      text-align: left;
      margin-bottom: 3rem;
    }

    .section-title {
      font-size: 2rem;
      font-weight: 700;
      color: var(--text-dark);
      margin-bottom: 0.5rem;
    }

    .section-title::after {
      content: '';
      display: block;
      width: 60px;
      height: 3px;
      background: var(--primary-blue);
      margin-top: 1rem;
    }

    .news-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 2rem;
      max-width: 1400px;
      margin: 0 auto;
    }

    .news-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
      transition: all 0.3s;
      cursor: pointer;
    }

    .news-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
    }

    .news-image {
      width: 100%;
      height: 220px;
      background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3rem;
    }

    .news-info {
      padding: 1.5rem;
    }

    .news-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.8rem;
      color: var(--text-dark);
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }

    .news-excerpt {
      color: var(--text-light);
      font-size: 0.9rem;
      margin-bottom: 1rem;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
    }

    .news-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.85rem;
      color: var(--text-light);
    }

    .news-read-more {
      color: var(--primary-blue);
      text-decoration: none;
      font-weight: 600;
    }

    /* åŠ¨ç”»æ•ˆæœ */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeInLeft {
      from {
        opacity: 0;
        transform: translateX(-50px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes fadeInRight {
      from {
        opacity: 0;
        transform: translateX(50px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes scaleIn {
      from {
        opacity: 0;
        transform: scale(0.9);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* æ»šåŠ¨è§¦å‘åŠ¨ç”» */
    .animate-on-scroll {
      opacity: 0;
      transition: none;
    }

    .animate-on-scroll.animated {
      animation-duration: 0.8s;
      animation-fill-mode: both;
      animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    }

    .fade-in-up {
      animation-name: fadeInUp;
    }

    .fade-in-left {
      animation-name: fadeInLeft;
    }

    .fade-in-right {
      animation-name: fadeInRight;
    }

    .scale-in {
      animation-name: scaleIn;
    }

    /* Banner åŠ¨ç”» */
    .banner-slide {
      opacity: 0;
      transition: opacity 0.8s ease-in-out;
      pointer-events: none;
    }

    .banner-slide.active {
      opacity: 1;
      pointer-events: auto;
    }

    .banner-content > * {
      animation: fadeInUp 1s ease-out backwards;
    }

    .banner-title {
      animation-delay: 0.2s;
    }

    .banner-subtitle {
      animation-delay: 0.4s;
    }

    .banner-content .btn {
      animation-delay: 0.6s;
    }

    .banner-brand {
      animation: scaleIn 1.2s ease-out backwards;
      animation-delay: 0.8s;
    }

    /* å¯¼èˆªæ åŠ¨ç”» */
    .navbar {
      animation: slideDown 0.6s ease-out;
    }

    /* æ‚¬åœåŠ¨ç”»å¢å¼º */
    .news-card {
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .content-image {
      transition: transform 0.4s ease;
    }

    .content-image:hover {
      transform: scale(1.02);
    }

    /* æŒ‰é’®åŠ¨ç”» */
    .btn {
      position: relative;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    .btn:hover::before {
      width: 300px;
      height: 300px;
    }

    /* å“åº”å¼ */
    @media (max-width: 768px) {
      .content-grid {
        grid-template-columns: 1fr;
        gap: 2rem;
      }

      .banner-brand {
        font-size: 3rem;
      }

      .banner-title {
        font-size: 1.8rem;
      }

      .content-text h2 {
        font-size: 1.8rem;
      }

      /* ç§»åŠ¨ç«¯è½®æ’­ç®­å¤´ */
      .banner-arrow {
        width: 40px;
        height: 40px;
        font-size: 1.5rem;
      }

      .banner-arrow-left {
        left: 1rem;
      }

      .banner-arrow-right {
        right: 1rem;
      }
    }
  </style>
</head>
<body>
  <!-- å¯¼èˆªæ  -->
  <nav class="navbar">
    <div class="nav-container">
      <a th:href="@{'/' + ${lang} + '/'}" class="logo">
        <img th:if="${site.logo}" th:src="@{'/static/' + ${site.logo}}" th:alt="${site.name}" style="height: 40px;">
        <span th:unless="${site.logo}" th:text="${site.name}">å“ç‰Œåç§°</span>
      </a>
      <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">â˜°</button>
      <ul class="nav-menu" id="navMenu">
         <li th:each="menu : ${menus}">
          <a th:href="@{'/' + ${lang} + '/' + ${menu.target_url}}" class="nav-link"
             th:text="${menu.menu_name}">èœå•</a>
        </li>
        <!-- å¤‡ç”¨èœå• -->
        <!-- <li th:if="${menus.isEmpty()}">
          <a th:href="@{'/' + ${lang} + '/about'}" class="nav-link" data-i18n="nav.about">å…³äºæˆ‘ä»¬</a>
        </li>
        <li th:if="${menus.isEmpty()}">
          <a th:href="@{'/' + ${lang} + '/innovation'}" class="nav-link" data-i18n="nav.innovation">ç§‘åˆ›åŠ¨æ€</a>
        </li>
        <li th:if="${menus.isEmpty()}">
          <a th:href="@{'/' + ${lang} + '/technology'}" class="nav-link" data-i18n="nav.technology">æŠ€æœ¯æ–¹æ¡ˆ</a>
        </li>
        <li th:if="${menus.isEmpty()}">
          <a th:href="@{'/' + ${lang} + '/news'}" class="nav-link" data-i18n="nav.news">æ–°é—»åŠ¨æ€</a>
        </li>
        <li th:if="${menus.isEmpty()}">
          <a th:href="@{'/' + ${lang} + '/contact'}" class="nav-link" data-i18n="nav.contact">è”ç³»æˆ‘ä»¬</a>
        </li> -->
        <li class="lang-switcher">
          <button type="button" class="lang-btn" th:classappend="${lang == 'zh'} ? 'active'" onclick="switchLanguage('zh'); return false;">ä¸­æ–‡</button>
          <button type="button" class="lang-btn" th:classappend="${lang == 'en'} ? 'active'" onclick="switchLanguage('en'); return false;">EN</button>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Hero Banner -->
  <section class="hero-banner">
    <!-- åŠ¨æ€Banner -->
    <div th:each="banner, iterStat : ${banners}"
         class="banner-slide"
         th:classappend="${iterStat.first} ? 'active'"
         th:style="${banner.image_url} ? 'background-image: url(' + @{'/static/' + ${banner.image_url}} + ');' : ''">
      <div class="banner-content">
        <h1 class="banner-title" th:text="${banner.title}">ç”µå­é›¾åŒ–è®¾å¤‡åŠæ–°å‹çƒŸè‰äº§å“</h1>
        <p class="banner-subtitle" th:text="${banner.subtitle}">ä¸€ç«™å¼æœåŠ¡å¼•é¢†è€…</p>
      </div>
    </div>
    <!-- é»˜è®¤Bannerï¼ˆå½“æ²¡æœ‰åç«¯æ•°æ®æ—¶ï¼‰ -->
    <div class="banner-slide active" th:if="${banners.isEmpty()}">
      <div class="banner-content">
        <h1 class="banner-title" data-i18n="hero.defaultTitle">ç”µå­é›¾åŒ–è®¾å¤‡åŠæ–°å‹çƒŸè‰äº§å“</h1>
        <p class="banner-subtitle" data-i18n="hero.defaultSubtitle">ä¸€ç«™å¼æœåŠ¡å¼•é¢†è€…</p>
        <a href="#services" class="btn" data-i18n="hero.learnMore">æ¢ç´¢æ›´å¤š</a>
        <div class="banner-brand" th:text="${site.name}">BRAND</div>
      </div>
    </div>

    <!-- å·¦å³ç®­å¤´æ§åˆ¶ -->
    <div class="banner-arrow banner-arrow-left" onclick="prevSlide()" th:if="${banners.size() > 1}">â€¹</div>
    <div class="banner-arrow banner-arrow-right" onclick="nextSlide()" th:if="${banners.size() > 1}">â€º</div>

    <!-- è½®æ’­å¯¼èˆªç‚¹ -->
    <div class="banner-dots" th:if="${banners.size() > 1}">
      <span th:each="banner, iterStat : ${banners}"
            class="banner-dot"
            th:classappend="${iterStat.first} ? 'active'"
            th:onclick="'goToSlide(' + ${iterStat.index} + ')'"></span>
    </div>
  </section>

  <!-- æœåŠ¡ä»‹ç»åŒº -->
  <section class="content-section" id="services" th:each="product, iterStat : ${products}" th:attr="data-product-id=${product.id}" th:if="${iterStat.index < 3}">
    <div class="content-grid">
      <div class="content-image animate-on-scroll fade-in-left" th:if="${iterStat.index % 2 == 0}" th:html="${product.mainImage}">

        <div th:if="${product.mainImage}" th:style="'background-image: url(' + ${product.mainImage} + ');background-size: cover; background-position: center; width: 100%; height: 400px; border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 4rem;'">
          
        </div>
      </div>
      <div class="content-text animate-on-scroll " th:classappend="${iterStat.index % 2 == 0 ? 'fade-in-right' : 'fade-in-left'}">
        <h2 th:text="${product.name}"> </h2>
        <p  th:text="${product.shortDescription}"></p>
        <a href="#" class="btn" data-i18n="services.details">è¯¦æƒ…</a>
      </div>

      <div class="content-image animate-on-scroll fade-in-right" th:if="${iterStat.index % 2 != 0}">
        <div th:if="${product.mainImage}" th:style="'background-image: url(' + ${product.mainImage} + ');background-size: cover; background-position: center; width: 100%; height: 400px; border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 4rem;'">
          
        </div>
      </div>
    </div>
  </section>
  <div style="text-align: center; margin-bottom: 3rem;" class="animate-on-scroll fade-in-up " >
    <a th:href="@{'/' + ${lang} + '/products'}" class="btn" data-i18n="services.viewAll">æŸ¥çœ‹å…¨éƒ¨</a>
  </div>


  <!-- æ–°é—»åŠ¨æ€ -->
  <section class="news-section">
    <div class="content-section">
      <div class="section-header animate-on-scroll fade-in-up">
        <h2 class="section-title" data-i18n="news.title">æ–°é—»åŠ¨æ€</h2>
      </div>

      <div class="news-grid">
        <div class="news-card animate-on-scroll scale-in" th:each="newsItem, iterStat : ${news}"
             th:onclick="'window.location.href=\'' + @{'/' + ${lang} + '/news/' + ${newsItem.id}} + '\''">
          <div class="news-image"
               th:if="${newsItem.cover_image}"
               th:style="'background-image: url(' + @{'/static/' + ${newsItem.cover_image}} + '); background-size: cover; background-position: center;'">
          </div>
          <div class="news-image" th:unless="${newsItem.cover_image}"
               th:style="'background: linear-gradient(135deg, hsl(' + ${(iterStat.index * 120) % 360} + ', 70%, 60%) 0%, hsl(' + ${((iterStat.index * 120) + 50) % 360} + ', 70%, 50%) 100%);'">
            <span>ğŸ“°</span>
          </div>
          <div class="news-info">
            <h3 class="news-title" th:text="${newsItem.title}">æ–°é—»æ ‡é¢˜</h3>
            <p class="news-excerpt" th:text="${newsItem.summary}">æ–°é—»æ‘˜è¦å†…å®¹</p>
            <div class="news-meta">
              <span class="news-date">ğŸ“… <span th:text="${#temporals.format(newsItem.publish_time, 'yyyy-MM-dd')}">2026-01-10</span></span>
              <a th:href="@{'/' + ${lang} + '/news/' + ${newsItem.id}}" class="news-read-more" data-i18n="news.readMore">æŸ¥çœ‹æ›´å¤š</a>
            </div>
          </div>
        </div>
      </div>

      <div style="text-align: center; margin-top: 3rem;" class="animate-on-scroll fade-in-up">
        <a th:href="@{'/' + ${lang} + '/news'}" class="btn" data-i18n="news.viewAll">æŸ¥çœ‹å…¨éƒ¨æ–°é—»</a>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-column">
        <h4 th:text="${site.name ?: 'CLOUPOR'}">CLOUPOR</h4>
        <p th:text="${siteI18n.description ?: ''}" ></p>
      </div>

      <div class="footer-column">
        <h4 data-i18n="nav.about">å…³äºæˆ‘ä»¬</h4>
        <a th:href="@{'/' + ${lang} + '/about'}" data-i18n="footer.companyProfile">å…¬å¸ç®€ä»‹</a>
        <!-- <a th:href="@{'/' + ${lang} + '/technology'}" data-i18n="footer.technology">æŠ€æœ¯å®åŠ›</a> -->
      </div>

      <div class="footer-column">
        <h4 data-i18n="products.title">äº§å“ä¸­å¿ƒ</h4>
        <a th:each="category : ${categories}"
           th:href="@{'/' + ${lang} + '/products?category=' + ${category.id}}"
           th:text="${category.name}">äº§å“åˆ†ç±»</a>
        <a href="#" th:if="${categories.isEmpty()}" data-i18n="footer.allProducts">å…¨éƒ¨äº§å“</a>
      </div>

      <div class="footer-column">
        <h4 data-i18n="footer.quickLinks">å¿«é€Ÿé“¾æ¥</h4>
        <a th:href="@{'/' + ${lang} + '/news'}" data-i18n="nav.news">æ–°é—»åŠ¨æ€</a>
        <a th:href="@{'/' + ${lang} + '/contact'}" data-i18n="nav.contact">è”ç³»æˆ‘ä»¬</a>
      </div>

      <div class="footer-column" th:if="${contact}">
        <h4 data-i18n="contact.title">è”ç³»æˆ‘ä»¬</h4>
        <p th:if="${contact.address}">ğŸ“ <span th:text="${contact.address}">åœ°å€</span></p>
        <p th:if="${contact.phone}">ğŸ“ <span th:text="${contact.phone}">ç”µè¯</span></p>
        <p th:if="${contact.email}">âœ‰ï¸ <span th:text="${contact.email}">é‚®ç®±</span></p>
      </div>
    </div>

    <div class="footer-bottom">
      <p>&copy; <span class="year"></span> <span th:text="${site.name ?: 'CLOUPOR'}">CLOUPOR</span>. <span data-i18n="footer.allRightsReserved">ä¿ç•™æ‰€æœ‰æƒåˆ©</span></p>
      <p th:if="${site.icpNumber}" th:text="${site.icpNumber}"></p>
    </div>
  </footer>

  <!-- è¿”å›é¡¶éƒ¨ -->
  <div class="back-to-top" onclick="scrollToTop()">â†‘</div>

  <!-- Scripts -->
  <script th:src="@{'/' + ${lang} + '/js/i18n.js'}"></script>
  <script th:src="@{'/' + ${lang} + '/js/main.js'}"></script>

  <script>
    window.onload = function() {
      document.querySelector('.year').textContent = new Date().getFullYear();

      // ç¡®ä¿è¯­è¨€åˆ‡æ¢æŒ‰é’®å¯ç”¨ - æ·»åŠ å¤‡ç”¨äº‹ä»¶ç›‘å¬
      const langButtons = document.querySelectorAll('.lang-btn');
      langButtons.forEach(function(button) {
        // ç§»é™¤å·²æœ‰çš„ç‚¹å‡»äº‹ä»¶ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
        const clone = button.cloneNode(true);
        button.parentNode.replaceChild(clone, button);

        // æ·»åŠ æ–°çš„ç‚¹å‡»äº‹ä»¶
        clone.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          const lang = this.textContent.trim() === 'ä¸­æ–‡' ? 'zh' : 'en';
          console.log('Language button clicked:', lang);
          switchLanguage(lang);
        });
      });
    };
    // Bannerè½®æ’­
    let currentSlide = 0;
    const slides = document.querySelectorAll('.banner-slide');
    const dots = document.querySelectorAll('.banner-dot');

    function goToSlide(n) {
      if (slides.length === 0) return;
      slides[currentSlide].classList.remove('active');
      if (dots.length > 0) {
        dots[currentSlide].classList.remove('active');
      }
      currentSlide = n % slides.length;
      slides[currentSlide].classList.add('active');
      if (dots.length > 0) {
        dots[currentSlide].classList.add('active');
      }
    }

    function prevSlide() {
      if (slides.length === 0) return;
      const prevIndex = (currentSlide - 1 + slides.length) % slides.length;
      goToSlide(prevIndex);
    }

    function nextSlide() {
      if (slides.length > 1) {
        goToSlide((currentSlide + 1) % slides.length);
      }
    }

    if (slides.length > 1) {
      setInterval(nextSlide, 5000);
    }

    // ç§»åŠ¨ç«¯èœå•åˆ‡æ¢
    function toggleMobileMenu() {
      const navMenu = document.getElementById('navMenu');
      navMenu.classList.toggle('active');
    }

    // è¯­è¨€åˆ‡æ¢
    function switchLanguage(lang) {
      try {
        const currentPath = window.location.pathname;
        let pathParts = currentPath.split('/').filter(p => p);

        // å¦‚æœç¬¬ä¸€ä¸ªéƒ¨åˆ†æ˜¯è¯­è¨€ä»£ç ï¼Œæ›¿æ¢å®ƒ
        if (pathParts.length > 0 && (pathParts[0] === 'zh' || pathParts[0] === 'en')) {
          pathParts[0] = lang;
        } else {
          // å¦åˆ™åœ¨å‰é¢æ·»åŠ è¯­è¨€ä»£ç 
          pathParts.unshift(lang);
        }

        const search = window.location.search || '';
        const newUrl = '/' + pathParts.join('/') + search;

        console.log('Switching language to:', lang, 'New URL:', newUrl);
        window.location.href = newUrl;
      } catch (error) {
        console.error('Language switch error:', error);
        // å¤‡ç”¨æ–¹æ¡ˆï¼šç›´æ¥é‡æ–°åŠ è½½é¡µé¢
        window.location.reload();
      }
    }

    // è¿”å›é¡¶éƒ¨
    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // è¿”å›é¡¶éƒ¨æŒ‰é’®æ˜¾ç¤º/éšè—
    window.addEventListener('scroll', function() {
      const backToTop = document.querySelector('.back-to-top');
      if (window.scrollY > 300) {
        backToTop.classList.add('show');
      } else {
        backToTop.classList.remove('show');
      }
    });

    // å¹³æ»‘æ»šåŠ¨åˆ°é”šç‚¹
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        const href = this.getAttribute('href');
        if (href !== '#' && href !== '#!') {
          e.preventDefault();
          const target = document.querySelector(href);
          if (target) {
            target.scrollIntoView({ behavior: 'smooth' });
          }
        }
      });
    });

    // æ»šåŠ¨è§¦å‘åŠ¨ç”»
    const animateElements = document.querySelectorAll('.animate-on-scroll');

    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry, index) => {
        if (entry.isIntersecting) {
          // æ·»åŠ å»¶è¿Ÿä»¥åˆ›å»ºè¿ç»­åŠ¨ç”»æ•ˆæœ
          setTimeout(() => {
            entry.target.classList.add('animated');
            if (entry.target.classList.contains('fade-in-up')) {
              entry.target.classList.add('fade-in-up');
            } else if (entry.target.classList.contains('fade-in-left')) {
              entry.target.classList.add('fade-in-left');
            } else if (entry.target.classList.contains('fade-in-right')) {
              entry.target.classList.add('fade-in-right');
            } else if (entry.target.classList.contains('scale-in')) {
              entry.target.classList.add('scale-in');
            }
          }, index * 100);
          observer.unobserve(entry.target);
        }
      });
    }, observerOptions);

    animateElements.forEach(element => {
      observer.observe(element);
    });

    // é”®ç›˜æ§åˆ¶è½®æ’­ï¼ˆå·¦å³ç®­å¤´é”®ï¼‰
    document.addEventListener('keydown', function(e) {
      if (slides.length <= 1) return;
      if (e.key === 'ArrowLeft') {
        prevSlide();
      } else if (e.key === 'ArrowRight') {
        nextSlide();
      }
    });

    // è§¦æ‘¸æ»‘åŠ¨æ”¯æŒ
    let touchStartX = 0;
    let touchEndX = 0;
    const bannerSection = document.querySelector('.hero-banner');

    if (bannerSection) {
      bannerSection.addEventListener('touchstart', function(e) {
        touchStartX = e.changedTouches[0].screenX;
      }, { passive: true });

      bannerSection.addEventListener('touchend', function(e) {
        touchEndX = e.changedTouches[0].screenX;
        handleSwipe();
      }, { passive: true });

      function handleSwipe() {
        if (slides.length <= 1) return;
        const swipeThreshold = 50;
        if (touchEndX < touchStartX - swipeThreshold) {
          nextSlide();
        } else if (touchEndX > touchStartX + swipeThreshold) {
          prevSlide();
        }
      }
    }
  </script>
</body>
</html>
